var phpfusion_tables={init:function(b,c,a){phpfusion_tables.toggleRow();phpfusion_tables.applyFilter();phpfusion_tables.masterCheck();phpfusion_tables.quickEdit(b,c,a);phpfusion_tables.customBox()},customBox:function(){$("body").on("click",".custom-table",function(a){let target=$("#"+$(this).data("table")+"-custom-box");if(target.is(":visible")){target.slideUp(150);$(this).find(".caret").removeClass("caret-up")}else{target.slideDown(150);$(this).find(".caret").addClass("caret-up")}})},toggleRow:function(){$("button.toggle-row").bind("click",function(a){$(this).closest("tr").toggleClass("expanded")});window.onresize=function(a){let viewPortWidth=$(window).width();if(viewPortWidth>1023){$("table.fusion-table tr").removeClass("expanded")}}},applyFilter:function(){$("#apply_filter").bind("click",function(a){a.preventDefault();$("#table_action").val($("#filter_actions").val());$("#table_frm").submit()})},masterCheck:function(){$("#chk_all, #chk_all2").bind("click",function(a){var b=$(this).is(":checked")?1:0;setChecked("table_frm","id[]",b);setChecked("table_frm","chk_all",b);setChecked("table_frm","chk_all2",b)})},fetchQuickEdit:function(e,c,a,d){var b={table_col:e,table_key:c,table_db:a};$.ajax({url:INCLUDES+"jquery/tables/table-fetch.php",type:"GET",data:b,dataType:"json",error:function(f){console.log("Failed to fetch file")},complete:function(f,g){if(g=="success"){if(f.responseJSON.status=="success"){d(e,c,a,f.responseJSON)}}}})},quickEdit:function(b,c,a){$(".quick_edit").bind("click",function(f){f.preventDefault();var g={table_col:$(this).data("value"),table_key:c,table_db:a};var d=function(k,h,i,e){$("#qc-input #qc_id").val(k);$.each(e.data,function(m,l){$("#qc-input #"+m).val(l)});if(k){var j=$("#form-row-"+k+" > td");$("#qc-input").find('button[name*="cancel_quick_editor"]').val(k);$("#qc-input").clone().appendTo(j).show();$("#form-row-"+k).show();$("#entry-row-"+k).hide()}};phpfusion_tables.fetchQuickEdit(g.table_col,c,a,d)});$("body").on("click",'button[name*="cancel_quick_editor"]',function(f){f.preventDefault();var g=$(this).val();var d=$("#form-row-"+g+" > td");if(g){d.html("");$("#form-row-"+g).hide();$("#entry-row-"+g).show()}});$("body").on("click",'button[name*="save_quick_editor"]',function(i){i.preventDefault();var g=$(this).find(".qc-spinner");g.show();var d={};var j={fusion_token:$("#table_frm").find('input[name*="fusion_token"]').val(),form_id:$("#table_frm").find('input[name*="form_id"]').val(),table_db:a,table_key:c};var f=$(this).closest("#qc-input").find("#qc_id").val();d[c]=f;$.each(JSON.parse(b),function(k,e){d[k]=$("#"+k).val()});j.table_fields=d;var h=$("#form-row-"+f+" > td");$.ajax({data:j,method:"post",url:INCLUDES+"jquery/tables/table-update.php",dataType:"json",success:function(k){},error:function(k){console.log("Error fetching file")},complete:function(k,l){if(l=="success"){if(k.responseJSON.status=="success"){$.each(k.responseJSON.data,function(e,n){var m=$("#entry-row-"+f).find('[data-col="'+e+'"] span.value');m.html(n)});g.hide();h.html("");$("#form-row-"+f).hide();$("#entry-row-"+f).show()}else{console.log(k.responseJSON.error_message)}}}})})}};