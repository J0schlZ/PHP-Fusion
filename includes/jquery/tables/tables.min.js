let phpfusion_tables={init:function(e,g,d,b,a,c,f){phpfusion_tables.toggleRow();phpfusion_tables.applyFilter(a);phpfusion_tables.masterCheck();phpfusion_tables.quickEdit(e,g,d,b,c,f);phpfusion_tables.customBox()},customBox:function(){$("body").on("click",".custom-table",function(a){let target=$("#"+$(this).data("table")+"-custom-box");if(target.is(":visible")){target.slideUp(150);$(this).find(".caret").removeClass("caret-up")}else{target.slideDown(150);$(this).find(".caret").addClass("caret-up")}})},toggleRow:function(){$("button.toggle-row").bind("click",function(a){$(this).closest("tr").toggleClass("expanded")});window.onresize=function(a){let viewPortWidth=$(window).width();if(viewPortWidth>1023){$("table.fusion-table tr").removeClass("expanded")}}},applyFilter:function(a){$("#apply_filter").bind("click",function(b){b.preventDefault();b.stopPropagation();let current_val=$("#filter_actions").val();let confirmation=function(d,c){let has_confirmation;$.each(d,function(e,f){if(e==c){if(confirm(f)){$("#table_action").val(c);$("#table_frm").submit()}has_confirmation=true}});if(!has_confirmation){$("#table_action").val(c);$("#table_frm").submit()}}confirmation(a,current_val)})},masterCheck:function(){$("#chk_all, #chk_all2").bind("click",function(a){let val=$(this).is(":checked")?1:0;setChecked("table_frm","id[]",val);setChecked("table_frm","chk_all",val);setChecked("table_frm","chk_all2",val)})},fetchQuickEdit:function(d,b,a,c){let data={table_col:d,table_key:b,table_db:a};$.ajax({url:INCLUDES+"jquery/tables/table-fetch.php",type:"GET",data:data,dataType:"json",error:function(f){console.log("Failed to fetch file")},complete:function(f,g){if(g=="success"){if(f.responseJSON.status=="success"){c(d,b,a,f.responseJSON)}}}})},quickEdit:function(d,f,c,a,b,e){$(".quick_edit").bind("click",function(g){g.preventDefault();let val={table_col:$(this).data("value"),table_key:f,table_db:a};let showQuickEdit=function(k,i,j,h){$(".qc-input #qc_id").val(k);if(k){let qc_rows=$("#form-row-"+k+" > td");$("#qc-input").find('button[name*="cancel_quick_editor"]').val(k);$("#qc-input").clone().appendTo(qc_rows).show();let frm=qc_rows;$.each(h.data,function(m,l){let inputDOM=frm.find("input[name="+m+"]");if(inputDOM.length){if(inputDOM.length>1){if(inputDOM.prop("type")=="radio"||inputDOM.prop("type")=="checkbox"){$(".qc-input input[name="+m+'][value *="'+l+'"]').prop("checked",true)}}else{$(".qc-input input[name="+m+"]").val(l)}}});$("#form-row-"+k).show();$("#entry-row-"+k).hide()}}phpfusion_tables.fetchQuickEdit(val.table_col,f,a,showQuickEdit)});$("body").on("click",'button[name*="cancel_quick_editor"]',function(g){g.preventDefault();let val=$(this).val();let qc_rows=$("#form-row-"+val+" > td");if(val){qc_rows.html("");$("#form-row-"+val).hide();$("#entry-row-"+val).show()}});$("body").on("click",'button[name*="save_quick_editor"]',function(g){g.preventDefault();let loader_ui=$(this).find(".qc-spinner");loader_ui.show();let fields={}let post_data={fusion_token:$("#table_frm").find('input[name*="fusion_token"]').val(),form_id:$("#table_frm").find('input[name*="form_id"]').val(),table_db:a,table_key:f,table_cat:c,table_ordering:b,table_multilang:e}let qcfrm=$(this).closest(".qc-input");let row_id=qcfrm.find("#qc_id").val();fields[f]=row_id;$.each(JSON.parse(d),function(i,h){let inputDOM=qcfrm.find("input[name="+i+"]");let val=inputDOM.val();if(inputDOM.prop("type")=="radio"||inputDOM.prop("type")=="checkbox"){val=qcfrm.find("input[name="+i+"]:checked").val()}fields[i]=val});post_data.table_fields=fields;console.log(post_data);let qc_rows=$("#form-row-"+row_id+" > td");$.ajax({data:post_data,method:"post",url:INCLUDES+"jquery/tables/table-update.php",dataType:"json",success:function(h){console.log(h)},error:function(h){console.log("Error fetching file")},complete:function(h,i){if(i=="success"){if(h.responseJSON.status=="success"){$.each(h.responseJSON.data,function(j,k){let s=$("#entry-row-"+row_id).find('[data-col="'+j+'"] span.value');let td_options=$("#entry-row-"+row_id).find('[data-col="'+j+'"]').data("col-options");if(td_options&&td_options[k]){s.html(td_options[k])}else{s.html(k)}});loader_ui.hide();qc_rows.html("");$("#form-row-"+row_id).hide();$("#entry-row-"+row_id).show()}else{console.log(h.responseJSON.error_message)}}}})})}};